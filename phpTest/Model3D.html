<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">	
        <title>
           Modelo 3D
        </title>
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link href="favicon.ico" type="image/x-icon" rel="icon"><link href="favicon.ico" type="image/x-icon" rel="shortcut icon">
        <script type='text/javascript' src='https://ssl-webplayer.unity3d.com/download_webplayer-3.x/3.0/uo/jquery.min.js'></script>
        <script type="text/javascript" src="js/lang/lang.js"></script>
        
        <link rel="stylesheet" href="unity/TemplateData/style.css">
        <script src="unity/TemplateData/UnityProgress.js"></script>  
        <script src="unity/Build/UnityLoader.js"></script>

        <script type="text/javascript">
            function onRuntimeInitialized(obj){
                setTimeout(function(){
                    if(QueryString.tumor){
                      setEstadiaje(QueryString.tumor);
                    }else{
                      setEstadiaje(TUMOR_NONE);
                      selectTumor($("#selector_tumor_none"));
                    }
                    $("#selector").fadeIn("slow"); 
                }, 3000);
            };

            var u = UnityLoader.instantiate("gameContainer", "unity/Build/Prostate 360 WB.json", {
                onProgress: UnityProgress,
                Module:{
                    TOTAL_MEMORY: 268435456,
                    onRuntimeInitialized: onRuntimeInitialized,
                }
            });
            
            function SaySomethingToUnity(estadiaje)
            {
                u.SendMessage("SceneChanger", "ChangeScene", estadiaje);
            }

            var QueryString = function () {
              // This function is anonymous, is executed immediately and 
              // the return value is assigned to QueryString!
              var query_string = {};
              var query = window.location.search.substring(1);
              var vars = query.split("&");
              for (var i=0;i<vars.length;i++) {
                var pair = vars[i].split("=");
                    // If first entry with this name
                if (typeof query_string[pair[0]] === "undefined") {
                  query_string[pair[0]] = pair[1];
                    // If second entry with this name
                } else if (typeof query_string[pair[0]] === "string") {
                  var arr = [ query_string[pair[0]], pair[1] ];
                  query_string[pair[0]] = arr;
                    // If third or later entry with this name
                } else {
                  query_string[pair[0]].push(pair[1]);
                }
              } 
                return query_string;
            } ();

            function selectTumor(obj){
                tumorArrow(false);
                var tum=$(obj).html();
                $("#selector_tumor_title_txt").html(lang['Primary Tumor']+tum);
                $("#selector_tumor_buttons").hide();
            }
            function setEstadiaje(tumor, calltounity){
                var estadiaje=ESTADIAJE_NONE;
                $("#coronal_image").hide();
                $("#coronal_image_t2b").hide();
                $("#coronal_image_t2c").hide();
                coronalArrow(false)
                var tum=lang['None'];
                switch(tumor){
                    case TUMOR_NONE:
                        break;
                    case TUMOR_2A:
                        estadiaje=ESTADIAJE_1;
                        tum="T2a";
                        break;
                    case TUMOR_2B:
                        estadiaje=ESTADIAJE_2A;
                        $("#coronal_image").show();
                        $("#coronal_image_images").show();
                        $("#coronal_image_t2b").show();
                        coronalArrow(true);
                        tum="T2b";
                        break;
                    case TUMOR_2C:
                        estadiaje=ESTADIAJE_2A;
                        $("#coronal_image").show();
                        $("#coronal_image_images").show();
                        $("#coronal_image_t2c").show();
                        tum="T2c";
                        coronalArrow(true);
                        break;
                    case TUMOR_3A:
                        estadiaje=ESTADIAJE_2B;
                        tum="T3a";
                        break;
                    case TUMOR_3B:
                        estadiaje=ESTADIAJE_3;
                        tum="T3b";
                        break;
                    case TUMOR_4:
                        estadiaje=ESTADIAJE_4;
                        tum="T4";
                        break;
                }
                $("#selector_tumor_buttons").hide()
                $("#selector_tumor_title_txt").html(lang['Primary Tumor']+tum);
                if(calltounity == undefined || calltounity != false){
                    SaySomethingToUnity(estadiaje);
                }
                
            }
            function coronalArrow(up){
                if(up){
                    $("#selector_coronal_title_arrow_down").hide();
                    $("#selector_coronal_title_arrow_up").show();
                }else{
                    $("#selector_coronal_title_arrow_down").show();
                    $("#selector_coronal_title_arrow_up").hide();
                }
            }
            function tumorArrow(up){
                if(up){
                    $("#selector_tumor_title_arrow_down").hide();
                    $("#selector_tumor_title_arrow_up").show();
                }else{
                    $("#selector_tumor_title_arrow_up").hide();
                    $("#selector_tumor_title_arrow_down").show();
                }
            }
            

   
            var ESTADIAJE_NONE = "0";
            var ESTADIAJE_1 = "1";
            var ESTADIAJE_2A = "2a";
            var ESTADIAJE_2B = "2b";
            var ESTADIAJE_3 = "3";
            var ESTADIAJE_4 = "4";
            
            var TUMOR_NONE="none";
            var TUMOR_2A="2a";
            var TUMOR_2B="2b";
            var TUMOR_2C="2c";
            var TUMOR_3A="3a";
            var TUMOR_3B="3b";
            var TUMOR_4="4";
            
            $(document).ready(function(){
                $("#selector").hide();
                $("#selector_tumor_none").click(function(){
                    setEstadiaje(TUMOR_NONE);
                    selectTumor(this);
                });
                $("#selector_tumor_t2a").click(function(){
                    setEstadiaje(TUMOR_2A);
                    selectTumor(this);
                });
                $("#selector_tumor_t2b").click(function(){
                    setEstadiaje(TUMOR_2B);
                    selectTumor(this);
                });
                $("#selector_tumor_t2c").click(function(){
                    setEstadiaje(TUMOR_2C);
                    selectTumor(this);
                });
                $("#selector_tumor_t3a").click(function(){
                    setEstadiaje(TUMOR_3A);
                    selectTumor(this);
                });
                $("#selector_tumor_t3b").click(function(){
                    setEstadiaje(TUMOR_3B);
                    selectTumor(this);
                });
                $("#selector_tumor_t4").click(function(){
                    setEstadiaje(TUMOR_4);
                    selectTumor(this);
                });
                $("#selector_tumor_title").click(function(){
                    if($("#selector_tumor_buttons").is(":visible")){
                        $("#selector_tumor_buttons").hide();
                        tumorArrow(false);    
                    }else{
                        $("#selector_tumor_buttons").show();
                        tumorArrow(true);
                    }
                });
                $("#coronal_image_title").click(function(){
                    if($("#coronal_image_images").is(":visible")){
                        $("#coronal_image_images").hide();
                        coronalArrow(false);
                    }else{
                        $("#coronal_image_images").show();
                        coronalArrow(true);
                    }
                });
            });
        </script>
        <link rel="stylesheet" type="text/css" href="css/model3d.css">
    </head>
    <body>
        <div class="webgl-content">
          <div id="gameContainer" style="width: 800px; height: 600px"></div>
          <div class="footer">
          </div>
        </div>
        <div id="selector">
            <div id="selector_tumor">
                <div class="selector_title_group" id="selector_tumor_title"> 
                    <div class="selector_title"  id="selector_tumor_title_txt">Tumor primario:</div>
                    <div class="selector_arrow" id="selector_tumor_title_arrows">
                        <img id="selector_tumor_title_arrow_down" class="arrow_image" src="img/arrow_down.png"/>
                        <img id="selector_tumor_title_arrow_up" class="arrow_image" style="display:none;" src="img/arrow_up.png"/>
                    </div>
                </div>
                <div id="selector_tumor_buttons">
                    <div class="selector_tumor_button" id="selector_tumor_none">Ninguno</div>
                    <div class="selector_tumor_button" id="selector_tumor_t2a">T2a</div>
                    <div class="selector_tumor_button" id="selector_tumor_t2b">T2b</div>
                    <div class="selector_tumor_button" id="selector_tumor_t2c">T2c</div>
                    <div class="selector_tumor_button" id="selector_tumor_t3a">T3a</div>
                    <div class="selector_tumor_button" id="selector_tumor_t3b">T3b</div>
                    <div class="selector_tumor_button" id="selector_tumor_t4">T4</div>
                </div>
            </div>
            <div id="coronal_image">
                <div class="selector_title_group" id="coronal_image_title">
                    <div class="selector_title" >Corte coronal</div>
                    <div class="selector_arrow">
                        <img class="arrow_image" id="selector_coronal_title_arrow_down" class="arrow_image"  src="img/arrow_down.png"/>
                        <img class="arrow_image" id="selector_coronal_title_arrow_up" class="arrow_image"  style="display:none;" src="img/arrow_up.png"/>
                    </div>
                </div>
                <div id="coronal_image_images">
                    <img id="coronal_image_t2b" width='100%'  src="img/t2b.png"/>
                    <img id="coronal_image_t2c" width='100%' src="img/t2c.png" style="display: none"/>
                </div>
            </div>

        </div>
    </body>
</html>